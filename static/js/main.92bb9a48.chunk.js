(this.webpackJsonpgui=this.webpackJsonpgui||[]).push([[0],{1:function(e,t,n){"use strict";n.d(t,"f",(function(){return r})),n.d(t,"e",(function(){return o})),n.d(t,"d",(function(){return u})),n.d(t,"i",(function(){return d})),n.d(t,"k",(function(){return v})),n.d(t,"l",(function(){return f})),n.d(t,"b",(function(){return m})),n.d(t,"a",(function(){return h})),n.d(t,"j",(function(){return b})),n.d(t,"h",(function(){return _})),n.d(t,"g",(function(){return p})),n.d(t,"m",(function(){return O})),n.d(t,"c",(function(){return x}));var i=n(12),a=n(11);function r(e){return Object(a.b)(e)}function o(e){return Object(a.a)(e)}function c(e,t){for(var n=0;n<e.length;)e[n]===t?e.splice(n,1):++n;return e}var l={parent:null,children:[],id:0,depth:0,methods:{}};function s(e){for(var t=[],n=e;n;n=n.parent)t.push(n.id);return t}function u(e,t,n){for(var i=[],a=t,r=e;a&&a.depth!==e.depth;)i.push(a.id),a=a.parent;if(!n)for(;a;){if(a.id!==r.id)return s(t);r=r.parent,a=a.parent}return i}function d(e,t,n){var i=n||l;console.log("setting",e,"to interace",n,"that is",i);for(var a=i;a;a=a.parent)a.methods[e]=[];v(e,t,n)}function v(e,t,n){for(var i=[n,t],a=n||l;a;a=a.parent){var r=a.methods[e];r?r.push(i):a.methods[e]=[i]}}function f(e,t,n){var i=n||l,a=[n,t];console.log("unsubscribing",e,"from interace",n,"that is",i);for(var r=i;r;r=r.parent){var o=r.methods[e];o&&c(o,a)}}function m(e,t,n){var a=t||l,r=void 0;return function(){for(var o=arguments.length,c=new Array(o),l=0;l<o;l++)c[l]=arguments[l];if(void 0===r){for(var s=function(){var n=u.methods[e];if(n)return{v:(r=function(){for(var e=new Array(n.length),t=0;t<n.length;t++){var a=Object(i.a)(n[t],2),r=a[0],o=a[1];e[t]=[r,o.apply(void 0,arguments)]}return e}).apply(void 0,c.concat([t]))}},u=a;u;u=u.parent){var d=s();if("object"===typeof d)return d.v}if(n)return;throw new Error('wrong interface name "'+e+'", existing interfaces: ['+Object.keys(a.methods)+"]")}return r.apply(void 0,c.concat([t]))}}function h(e,t){var n=m(e,t,!1);return function(){var e=n.apply(void 0,arguments),t=e[0],i=t[1];return i}}function b(e){var t=e||l,n={parent:t,children:[],id:t.children.length,depth:1+t.depth,methods:{}};return t.children.push(n),n}function _(e,t){var n=!1;function a(){return n}return function(){if(n)return a;n=!0;var r=t();n=!1;for(var o={},c=0;c<r.length;c++){var l=Object(i.a)(r[c],2),s=l[0],d=l[1];if(d!==a)o[u(e,s)]=d}return o}}function p(e,t,n){if("undefined"==typeof t&&(t=e,e=0),"undefined"==typeof n&&(n=1),n>0&&e>=t||n<0&&e<=t)return[];for(var i=[],a=e;n>0?a<t:a>t;a+=n)i.push(a);return i}function O(e,t){return(n=[e,t])[0].map((function(e,t){return n.map((function(e){return e[t]}))}));var n}function x(e){return new URLSearchParams(window.location.search).get(e)}},18:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return serverHandlerInit}));var _home_admin_my_media_text_code_hacalc_web_gui_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_toConsumableArray__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(7),md5__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(19),md5__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(md5__WEBPACK_IMPORTED_MODULE_1__),_Util__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(1);function isInternal(e){return e.includes("$")}var SERVER_ADDRESS=eval("SERVER_ADDRESS_REMOTE");function serverHandlerSend(e,t){var n=encodeURIComponent(e);fetch(SERVER_ADDRESS+"/calc/"+n).then((function(n){n.text().then((function(n){var i=n.split("\n"),a=i.map((function(e){return e.trim()})).map((function(e){return e.startsWith("->")?e.substring(2).trim():""})).filter((function(e){return""!==e})).map((function(e){return{text:e,isResponse:!0,isInternal:isInternal(e),isFinal:!1}}));if(0===a.length){var r=i.filter((function(e){return""!==e}));a.push({text:r[r.length-1],isResponse:!0,isFinal:!0,isInternal:!1})}else{var o=a[a.length-1];o.isFinal=!0,o.isInternal=!1}var c=[{text:e,isResponse:!1}].concat(Object(_home_admin_my_media_text_code_hacalc_web_gui_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_toConsumableArray__WEBPACK_IMPORTED_MODULE_0__.a)(a));t(c)}))}))}var serverHandlerShare=function(e){var t=Object(_Util__WEBPACK_IMPORTED_MODULE_2__.f)(e),n=md5__WEBPACK_IMPORTED_MODULE_1__(t);return fetch(SERVER_ADDRESS+"/share/"+n,{method:"POST",redirect:"follow",mode:"no-cors",headers:{"Content-Type":"plain/text","Access-Control-Allow-Origin":"*"},body:t}).then((function(e){var t=window.location;window.open(t.origin+t.pathname+"?load="+n),console.log("response:",e)})),t};function serverHandlerLoad(e){return new Promise((function(t,n){function i(e){var n=Object(_Util__WEBPACK_IMPORTED_MODULE_2__.e)(e);t(n)}fetch(SERVER_ADDRESS+"/load/"+e).then((function(e){e.text().then(i)}))}))}function serverHandlerInit(){Object(_Util__WEBPACK_IMPORTED_MODULE_2__.i)("server-calc",serverHandlerSend),Object(_Util__WEBPACK_IMPORTED_MODULE_2__.i)("share",serverHandlerShare),Object(_Util__WEBPACK_IMPORTED_MODULE_2__.i)("load",serverHandlerLoad)}},20:function(e,t,n){e.exports=n(30)},25:function(e,t,n){},30:function(e,t,n){"use strict";n.r(t);var i=n(0),a=n.n(i),r=n(15),o=n.n(r),c=n(2),l=n(3),s=n(5),u=n(4),d=(n(25),n(10)),v=n.n(d),f=n(16),m=n(17),h=n(7),b=n(6),_=n(1),p=function(e){Object(s.a)(n,e);var t=Object(u.a)(n);function n(e){var i;Object(c.a)(this,n),(i=t.call(this,e)).styles={width:"100%",paddingLeft:"5px"},i.immediateValue=void 0,i.updateValue=void 0,i.onChangeHandler=void 0,i.onResponseHandler=void 0,i.onSubmitHandler=void 0,i.immediateValue="",i.state={value:i.immediateValue};var a=Object(_.a)("history-add-response",e.ictx),r=Object(_.a)("server-calc",e.ictx);return i.updateValue=function(e){i.immediateValue=e,i.setState({value:e})},i.onChangeHandler=function(e){var t=e.target.value;i.updateValue(t)},i.onResponseHandler=function(e){a(e)},i.onSubmitHandler=function(e){e.preventDefault(),console.log("submitting",i.immediateValue),r(i.immediateValue,i.onResponseHandler),i.updateValue("")},i}return Object(l.a)(n,[{key:"render",value:function(){return a.a.createElement("div",null,a.a.createElement("form",{action:"#",onSubmit:this.onSubmitHandler},a.a.createElement("input",{key:"ConsoleInput",type:"text",style:this.styles,value:this.state.value,onChange:this.onChangeHandler})))}}]),n}(i.Component),O=function(e){Object(s.a)(n,e);var t=Object(u.a)(n);function n(e){var i;Object(c.a)(this,n),(i=t.call(this,e)).ictx=void 0,i.id=void 0,i.mounted=void 0,i.isInternal=void 0,i.isMinimal=void 0,i.text=void 0,i.style=void 0,i.elem=void 0,i.serialize=void 0,i.deserialize=void 0,i.wrapSetState=void 0,i.setVisibility=void 0,i.ictx=e.ictx,i.id=e.id,i.mounted=!1;var r=e.elem,o="string"==typeof r,l=!o&&r.isResponse;i.isInternal=r.isInternal,i.isMinimal=r.isFinal||!r.isResponse,i.text=o?r:r.text,i.style=l?{backgroundColor:"#61dafb",border:"1px solid #61dafb"}:{backgroundColor:"white"},i.style.width="100%",i.style.paddingLeft="5px",i.elem=a.a.createElement("input",{tabIndex:-1,readOnly:!0,value:i.text,style:i.style}),i.serialize=function(){return i.state};var s=Object(_.a)("deserialize-state",i.ictx);i.state=s(),Object(_.k)("serialize-state",i.serialize,i.ictx),i.wrapSetState=function(e){i.mounted?i.setState(e):i.state=e(i.state)},i.setVisibility=function(e){switch(e){case"Minimal":return i.wrapSetState((function(e){return{hide:!i.isMinimal}}));case"Internals":return i.wrapSetState((function(e){return{hide:i.isInternal}}));case"Internals*":return i.wrapSetState((function(e){return{hide:!1}}));default:throw new Error("Unknown visibility mode: "+e)}},Object(_.k)("history-update",i.setVisibility,i.ictx);var u=Object(_.a)("get-visibility-mode",i.ictx);if(!i.state){var d=u();i.setVisibility(d)}return i}return Object(l.a)(n,[{key:"componentDidMount",value:function(){this.mounted=!0}},{key:"componentWillUnmount",value:function(){this.mounted=!1,Object(_.l)("history-update",this.setVisibility,this.ictx),Object(_.l)("serialize-state",this.serialize,this.ictx)}},{key:"render",value:function(){var e;return e=this.state.hide?null:this.elem,a.a.createElement(a.a.Fragment,null,e)}}]),n}(i.Component),x=function(e){Object(s.a)(n,e);var t=Object(u.a)(n);function n(e){var i;Object(c.a)(this,n),(i=t.call(this,e)).ictx=void 0,i.id=void 0,i.loadId=void 0,i.serialize=void 0,i.messagesEnd=void 0,i.scrollToBottom=function(e){var t=e?"smooth":"auto";i.messagesEnd.scrollIntoView({behavior:t})},i.ictx=e.ictx,i.id=e.id,i.loadId=e.loadId,i.serialize=function(){return i.state};var a=Object(_.a)("deserialize-state",i.ictx);i.state=a()||{hist:[]},Object(_.k)("serialize-state",i.serialize,i.ictx);return Object(_.i)("history-add-response",(function(e){i.setState((function(t){return{hist:[].concat(Object(h.a)(t.hist),Object(h.a)(e))}}))}),i.ictx),i}return Object(l.a)(n,[{key:"componentDidUpdate",value:function(){this.scrollToBottom(!0)}},{key:"componentDidMount",value:function(){this.scrollToBottom(!1)}},{key:"render",value:function(){var e=this,t=this.state.hist,n=Object(_.g)(t.length).map((function(t){return e.id+"historyElement#"+t})),i=Object(_.m)(t,n).map((function(t){return a.a.createElement(O,{ictx:Object(_.j)(e.ictx),elem:t[0],id:t[1],key:t[1]})}));return a.a.createElement("div",null,i,a.a.createElement("div",{style:{float:"left",clear:"both"},ref:function(t){e.messagesEnd=t}}))}}]),n}(i.Component),j=function(e){Object(s.a)(n,e);var t=Object(u.a)(n);function n(e){var i;Object(c.a)(this,n),(i=t.call(this,e)).ictx=void 0,i.onClick=void 0,i.ictx=e.ictx,i.state=null;var a=Object(_.a)("share"),r=Object(_.a)("serialize-window",i.ictx);return i.onClick=function(e){var t=r();a(t)},i}return Object(l.a)(n,[{key:"render",value:function(){return a.a.createElement("button",{className:"btn btn-primary",tabIndex:-1,onClick:this.onClick},"Share")}}]),n}(i.Component),y=function(e){Object(s.a)(n,e);var t=Object(u.a)(n);function n(e){var i;Object(c.a)(this,n),(i=t.call(this,e)).ictx=void 0,i.id=void 0,i.serialize=void 0,i.nextStateText=void 0,i.cycleState=void 0,i.getVisibilityMode=void 0,i.onClick=void 0,i.ictx=e.ictx,i.id=e.id,i.serialize=function(){return i.state};var a=Object(_.a)("deserialize-state",i.ictx);i.state=a()||{text:"Minimal"},Object(_.k)("serialize-state",i.serialize,i.ictx),i.nextStateText=function(e){switch(e){case"Minimal":return"Internals";case"Internals":return"Internals*";case"Internals*":return"Minimal";default:throw new Error("Unknonw state: "+e)}},i.cycleState=function(e){return Object(b.a)(Object(b.a)({},e),{},{text:i.nextStateText(e.text)})},i.getVisibilityMode=function(){return i.state.text},Object(_.i)("get-visibility-mode",i.getVisibilityMode,i.ictx);var r=Object(_.b)("history-update",i.ictx,!0);return i.onClick=function(e){i.setState((function(e){var t=i.cycleState(e);return r(t.text),t}))},i}return Object(l.a)(n,[{key:"render",value:function(){return a.a.createElement("button",{className:"btn btn-primary",tabIndex:-1,onClick:this.onClick},this.nextStateText(this.state.text))}}]),n}(i.Component);function E(e,t){return a.a.createElement("button",{className:"btn btn-primary",tabIndex:-1,onClick:t},e)}var w=function(e){Object(s.a)(n,e);var t=Object(u.a)(n);function n(e){var i;Object(c.a)(this,n),(i=t.call(this,e)).styles={width:"40vw",float:"left",margin:"20px",textAlign:"left",height:"100%"},i.historyStyles={height:"100%",overflow:"hidden",overflowY:"auto"},i.ictx=void 0,i.count=void 0,i.id=void 0,i.serializedState=void 0,i.style=void 0,i.horizontalStyle=void 0,i.normalStyle=void 0,i.deserialize=void 0,i.onCloneClick=void 0,i.onCloseClick=void 0,i.state={},i.style=e.horizontal?i.horizontalStyle:i.normalStyle,i.ictx=e.ictx,i.count=e.count,i.id=e.id,i.serializedState=e.serializedState||{},i.deserialize=function(e){var t=Object(_.d)(i.ictx,e,!1);return i.serializedState[t]},Object(_.k)("deserialize-state",i.deserialize,i.ictx);var a=Object(_.a)("add-window",i.ictx),r=Object(_.a)("remove-window",i.ictx),o=Object(_.b)("serialize-state",i.ictx,!1),l=Object(_.h)(i.ictx,o);return Object(_.k)("serialize-state",l,i.ictx),Object(_.i)("serialize-window",l,i.ictx),i.onCloneClick=function(e){var t=l();a(t)},i.onCloseClick=function(e){r()},i}return Object(l.a)(n,[{key:"render",value:function(){return a.a.createElement("div",{style:this.styles},a.a.createElement("div",{className:"btn-group d-flex",role:"group"},E("Close",this.onCloseClick),a.a.createElement(y,{ictx:Object(_.j)(this.ictx),id:this.id+":InternalsButton"}),a.a.createElement(j,{ictx:Object(_.j)(this.ictx)}),E("Clone",this.onCloneClick)),a.a.createElement("div",{style:this.historyStyles},a.a.createElement(x,{ictx:Object(_.j)(this.ictx),id:this.id+":HistoryView"}),a.a.createElement(p,{ictx:Object(_.j)(this.ictx)})))}}]),n}(i.Component),g=function(e){Object(s.a)(n,e);var t=Object(u.a)(n);function n(e){var i;Object(c.a)(this,n),(i=t.call(this,e)).styles={display:"inline-flex",height:"90%"},i.ictx=void 0,i.id=void 0,i.mounted=void 0,i.windows=void 0,i.initWindow=void 0,i.addWindow=void 0,i.state=void 0,i.ictx=e.ictx,i.id=e.id,i.mounted=!1,i.state={count:0,indexes:[]},i.windows=[];var a=Object(_.a)("intro-show",null);return i.initWindow=function(e,t){return function(n){var r=i.id+"DesktopWindow#"+t,o={ictx:null,serializedState:n,id:r,key:r,count:t},c=Object(_.j)(i.ictx);o.ictx=c,Object(_.k)("add-window",i.addWindow(t),c);var l;if(Object(_.k)("remove-window",(function(){var e=i.windows.filter((function(e){return e.count!==t}));console.log("removing window: ",o.id,"new:",e),i.windows=e,i.setState((function(e){return Object(b.a)(Object(b.a)({},e),{},{indexes:e.indexes.filter((function(e){return e!==t}))})})),0===e.length&&(a(),i.addWindow(null)(null))}),c),null===e)l=[].concat(Object(h.a)(i.windows),[o]);else{l=[];var s,u=Object(m.a)(i.windows);try{for(u.s();!(s=u.n()).done;){var d=s.value;l.push(d),d.count===e&&l.push(o)}}catch(v){u.e(v)}finally{u.f()}}i.windows=l}},i.addWindow=function(e){return function(t){var n=null,a=void 0,r=function(r){return null===n&&(n=!0,a=r.count+1,i.initWindow(e,a)(t)),{count:a,indexes:[].concat(Object(h.a)(r.indexes),[[e,a]])}};i.mounted?i.setState(r):i.state=r(i.state)}},function(){var e=Object(f.a)(v.a.mark((function e(){var t,n,a;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(n=Object(_.c)("load"))){e.next=9;break}return a=Object(_.a)("load",null),e.next=5,a(n);case 5:t=e.sent,console.log("loading from state:",t),e.next=10;break;case 9:t=null;case 10:i.addWindow(null)(t);case 11:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()(),i}return Object(l.a)(n,[{key:"componentDidMount",value:function(){this.mounted=!0}},{key:"render",value:function(){var e=this.windows.map((function(e){return a.a.createElement(w,{key:e.id,id:e.id,serializedState:e.serializedState,ictx:e.ictx})}));return a.a.createElement("div",{style:this.styles},e)}}]),n}(i.Component),k=function(e){Object(s.a)(n,e);var t=Object(u.a)(n);function n(e){var i;Object(c.a)(this,n),(i=t.call(this,e)).mounted=void 0,i.examples=["2 + 2 * 2","2 ^ 77","1 << 77","base 2 (1 << 77)","0001#2 + 100101#2","FF00AA#16 + 100101#2","0100#2 | 1001#2","digits 100 pi"],i.mapped=i.examples.map((function(e){return a.a.createElement(a.a.Fragment,{key:e}," Try ",a.a.createElement("code",null," ",e," ")," ",a.a.createElement("br",null)," ")}));var r=!Object(_.c)("load");i.state={visible:r};var o=function(e){return function(){if(e!==i.state.visible){var t=function(t){return Object(b.a)(Object(b.a)({},t),{},{visible:e})};i.mounted?i.setState(t):i.state=t(i.state)}}};return Object(_.k)("server-calc",o(!1)),Object(_.k)("intro-show",o(!0)),i}return Object(l.a)(n,[{key:"componentDidMount",value:function(){this.mounted=!0}},{key:"render",value:function(){return this.state.visible?a.a.createElement(a.a.Fragment,null,a.a.createElement("img",{src:"big-logo.png",alt:"Logo"}),a.a.createElement("p",null," This is ",a.a.createElement("a",{href:"https://github.com/Donaim/hacalc"},"Hacalc")," - a calculator based on term rewriting "),a.a.createElement("p",null," ",this.mapped," ")):null}}]),n}(i.Component),S=function(e){Object(s.a)(n,e);var t=Object(u.a)(n);function n(e){var i;return Object(c.a)(this,n),(i=t.call(this,e)).styles={height:"90vh"},i.innerStyles={marginTop:"auto",marginBottom:"auto",marginLeft:"auto",marginRight:"auto",height:"90%"},i.ictx=void 0,i.state=void 0,i.serialize=void 0,i.ictx=Object(_.j)(null),i.state=null,i.serialize=function(){return null},Object(_.k)("serialize-state",i.serialize,i.ictx),i}return Object(l.a)(n,[{key:"render",value:function(){return console.log("rendering app!"),a.a.createElement("div",{className:"App-header",style:this.styles},a.a.createElement(k,null),a.a.createElement("div",{style:this.innerStyles},a.a.createElement(g,{ictx:this.ictx})))}}]),n}(i.Component),C=(n(27),n(18));Object(C.a)(),o.a.render(a.a.createElement(a.a.StrictMode,null,a.a.createElement(S,null)),document.getElementById("root"))}},[[20,1,2]]]);
//# sourceMappingURL=main.92bb9a48.chunk.js.map